<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; object-src 'none'"><meta name="generator" content="Some custom Common Lisp"><meta name="description" content="Blog archives for topic retro"><link rel="alternate" href="/feed.xml" title="Fanael's random ruminations" type="application/rss+xml"><link rel="stylesheet" href="/static/theme.css"><link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><title>Blog archives for topic retro - Fanael's random ruminations</title></head><body><a id="skip-nav" href="#main">Skip to main content</a><header id="mainheader">Fanael's random ruminations</header><nav aria-label="Primary"><ul id="navmenu"><li><a href="/">Main page</a></li><li><a href="/archives/">Archives</a></li><li><a href="https://github.com/Fanael/fanael.github.io/">GitHub</a></li><li><a rel="author" href="/pages/about.html">About</a></li></ul></nav><main id="main"><header><h1>Archives for topic retro</h1></header><nav class="toc" aria-labelledby="toc-label"><span id="toc-label">Table of contents</span><ol><li><a href="#stockfish-on-windows-98">Current Stockfish on Windows 98?!</a></li></ol></nav><article id="stockfish-on-windows-98"><header><h2><a href="/stockfish-on-windows-98.html">Current Stockfish on Windows 98?!</a></h2><p>Published on the <time datetime="2020-09-24">24th of September 2020</time></p><p>Topics: <a href="/archives/topic-retro.html">retro</a>, <a href="/archives/topic-windows-9x.html">windows-9x</a></p></header><p>A few weeks ago I had this weird idea: would it be possible to make an up-to-date version of <a href="https://stockfishchess.org/">Stockfish</a> run on Windows 98? There's an immediate problem with that: Stockfish is written in C++17, which is the still-current, at the time of writing, revision of the C++ language; surely there are no C++17 capable compilers that can still target something as old as Windows 98?</p><div class="note"><p>Disclaimer: in this article, by "Windows 98" I mean Windows 98 second edition with the main files of the <a href="https://www.techtalk.cc/viewtopic.php?t=65">unofficial service pack</a> installed, which is a convenient bundle of official and unofficial patches. I don't care about Windows 98 first edition, nor the second edition <em>without</em> those updates installed. Note that <a href="https://sourceforge.net/projects/kernelex/">KernelEx</a> is <em>not needed</em>.</p><p>I'm fully aware this has no practical value, but it was a fun thing to do.</p></div><p>As it turns out, the GNU toolchain, comprised of <a href="https://www.gnu.org/software/binutils/">GNU binutils</a> and <a href="https://gcc.gnu.org/">GCC, the GNU Compiler Collection</a>, doesn't particularly care about all the different Windows versions and will happily output a binary that works on any 32-bit Windows.</p><p>The compiler itself, assembler and linker are only a part of a functional compiler package, though. There's one part we're missing: the runtime library, which provides the system-specific program initialization code that runs before the <code>main</code> function. Since we're using GCC, the obvious choice is the <a href="https://sourceforge.net/projects/mingw-w64/">mingw-w64</a> runtime. It also provides Windows API headers, bindings to (pretty much all the extant versions of) the Microsoft Visual C++ standard C library, and a POSIX threading API compatibility layer, <cite class="program-name">winpthreads</cite>, which is required for C++ standard threading library support in GCC.</p><p>Fortunately for us, a minimal Windows program compiled with GCC with mingw-w64 appears to work fine when executed under Windows 98:</p><pre class="codeblock" data-code-language="C++"><code><span class="c-c">#</span><span class="c-c">include</span> <span class="c-c">&lt;windows.h&gt;</span><span class="c-c">
</span>
<span class="c-k">int</span> WINAPI WinMain(HINSTANCE, HINSTANCE, <span class="c-k">char</span>*, <span class="c-k">int</span>)
{
    MessageBoxA(<span class="c-k">nullptr</span>, <span class="c-s">"</span><span class="c-s">Hello world!</span><span class="c-s">"</span>, <span class="c-s">"</span><span class="c-s">A test</span><span class="c-s">"</span>, MB_OK);
    <span class="c-k">return</span> <span class="c-m">0</span>;
}
</code></pre><p>So maybe all we have to do is to compile Stockfish and it will just work on Windows 98…?</p><a class="read-full" href="/stockfish-on-windows-98.html" aria-label="Read the full article: Current Stockfish on Windows 98?!">Read the full article…</a></article></main><nav aria-label="Chronological, secondary"><ul id="prevnext"><li class="top"><a href="#skip-nav">↑ Top ↑</a></li><li class="prev"></li><li><a href="/archives/">Blog archives</a></li><li class="next"></li></ul></nav><footer><ul id="footerstuff"><li>Powered by HTML &amp; CSS</li><li>Copyright © 2019-2021 Fanael Linithien</li><li>Licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></li></ul></footer></body></html>