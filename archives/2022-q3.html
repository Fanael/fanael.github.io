<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="generator" content="Some custom Common Lisp"><meta name="description" content="Blog archives for the third quarter of 2022"><script defer src="/static/fixes.js"></script><link rel="alternate" href="/feed.xml" title="Fanael's random ruminations" type="application/rss+xml"><link rel="stylesheet" href="/static/theme.css"><link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><title>Blog archives for the third quarter of 2022 - Fanael's random ruminations</title></head><body><header id="top-header"><a id="skip-nav" class="at-only" href="#main">Skip to main content</a><span>Fanael's random ruminations</span></header><nav aria-label="Primary"><ul id="top-nav"><li><a href="/">Main page</a></li><li><a href="/archives/">Archives</a></li><li><a href="https://github.com/Fanael/fanael.github.io/">GitHub</a></li><li><a rel="author" href="/pages/about.html">About</a></li></ul></nav><main id="main"><header><h1>Archives for the third quarter of 2022</h1></header><nav class="toc" aria-labelledby="toc-label"><span id="toc-label">Table of contents</span><ol><li><a href="#you-can-embrace-extend-extinguish-free-software">Yes, you can embrace, extend, extinguish free software</a></li><li><a href="#dotnet-object-init-slow">.NET object initialization is surprisingly slow</a></li></ol></nav><article id="you-can-embrace-extend-extinguish-free-software"><header><h2><a href="/you-can-embrace-extend-extinguish-free-software.html">Yes, you can embrace, extend, extinguish free software</a></h2><p>Published on the <time datetime="2022-09-22">22nd of September 2022</time></p></header><p>KHTML</p><a class="read-full" href="/you-can-embrace-extend-extinguish-free-software.html" aria-label="Read the full article: Yes, you can embrace, extend, extinguish free software">Read the full article…</a></article><article id="dotnet-object-init-slow"><header><h2><a href="/dotnet-object-init-slow.html">.NET object initialization is surprisingly slow</a></h2><p>Published on the <time datetime="2022-08-18">18th of August 2022</time></p><p>Topics: <a href="/archives/topic-java.html">java</a>, <a href="/archives/topic-dot-net.html">dot-net</a>, <a href="/archives/topic-garbage-collection.html">garbage-collection</a></p></header><p>…sometimes, at least. When compared to Java under OpenJDK.</p><p>I was performing some experiments with various ways of implementing <a href="https://en.wikipedia.org/wiki/Persistent_data_structure">persistent</a> random-access sequences. At one point, after implementing some of them in Java, I had the brilliant idea to try and implement some of them in C# as well and see how performance compares.</p><p>Unfortunately, this comparison was not very favorable towards C#: it consistently performed around 4-6× slower, <em>four to six times</em>, than the <em>same</em> data structure in Java. That was certainly… <em>not</em> what I expected. I was expecting the performance to be very close, if not C#-favored. After all, the Common Language Runtime supports value types, whereas the Java Virtual Machine at the moment does not, and some of the data structures I tested can benefit from reduced indirection.</p><p>Profiling revealed that the hottest functions were those that created new objects. While this does make sense, as persistent data structures using path copying <em>do</em> create many objects, spending north of 80% wall clock time on <em>just</em> allocating new objects, instead of on actual logic, is certainly a lot.</p><p>The next step I took to understand why those functions take so much time was, naturally, looking at the generated code. The differences were quite stark, and explained the performance gap almost immediately, so why don't we take a look?</p><a class="read-full" href="/dotnet-object-init-slow.html" aria-label="Read the full article: .NET object initialization is surprisingly slow">Read the full article…</a></article></main><nav aria-label="Chronological, secondary"><ul id="order-nav"><li class="top"><a href="#skip-nav"><span aria-hidden="true">↑ </span>Top<span aria-hidden="true"> ↑</span></a></li><li class="prev"></li><li><a href="/archives/">Blog archives</a></li><li class="next"></li></ul></nav><footer><ul id="footer"><li><a href="/pages/offline-mode.html">Offline mode</a></li><li>Powered by HTML &amp; CSS</li><li>Copyright © 2019-2022 Fanael Linithien</li><li>Licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></li></ul></footer></body></html>