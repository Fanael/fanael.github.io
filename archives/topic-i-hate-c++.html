<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta http-equiv="Content-Security-Policy" content="default-src 'self'"><meta name="generator" content="Some custom Common Lisp"><link rel="canonical" href="archives/topic-i-hate-c++.html"><link rel="stylesheet" href="/static/theme.css"><link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><title>Blog archives for topic i-hate-c++ - Fanael's random ruminations</title></head><body><header id="mainheader">Fanael's random ruminations</header><nav><ul id="navmenu"><li><a href="/">Main page</a></li><li><a href="/archives/">Archives</a></li><li><a href="https://github.com/Fanael/fanael.github.io/">GitHub</a></li><li><a rel="author" href="/pages/about.html">About</a></li></ul></nav><main><header><h1>Archives for topic i-hate-c++</h1></header><nav class="toc"><ol><li><a href="#breaking-empty-base-optimization">How to: accidentally break empty base optimization</a></li></ol></nav><article id="breaking-empty-base-optimization"><header><h2><a href="/breaking-empty-base-optimization.html">How to: accidentally break empty base optimization</a></h2><p class="publishdate">Published on the <time datetime="2019-12-20">20th of December 2019</time></p></header><p>A reasonably common idiom in C++ code is the use of the following or similar class to inhibit move and copy operations, to avoid having to repeat the four <code>delete</code>d functions in every class: </p><pre class="codeblock" data-code-language="C++"><code><span class="c-k">class</span> noncopyable {
<span class="c-k">public</span>:
    noncopyable(<span class="c-k">const</span> noncopyable&amp;) = <span class="c-k">delete</span>;
    noncopyable(noncopyable&amp;&amp;) = <span class="c-k">delete</span>;
    noncopyable&amp; <span class="c-k">operator</span>=(<span class="c-k">const</span> noncopyable&amp;) = <span class="c-k">delete</span>;
    noncopyable&amp; <span class="c-k">operator</span>=(noncopyable&amp;&amp;) = <span class="c-k">delete</span>;
<span class="c-k">protected</span>:
    noncopyable() = <span class="c-k">default</span>;
    ~noncopyable() = <span class="c-k">default</span>;
};
</code></pre><aside><p>I'm personally not a huge fan of the <code>noncopyable</code> name, because it describes <em>how</em> instead of <em>why</em>, but that's neither here nor there.</p></aside><p>The <code>noncopyable</code> class can be mixed in using inheritance, like so:</p><pre class="codeblock" data-code-language="C++"><code><span class="c-k">class</span> foo : <span class="c-k">private</span> noncopyable {
    <span class="c-c">// …
</span>};
</code></pre><p>So far, so good, but there's more to it than meets the eye.</p></article></main><nav><ul id="prevnext"><li class="top"><a href="#">↑ Top ↑</a></li><li class="prev"></li><li><a href="/archives/">Blog archives</a></li><li class="next"></li></ul></nav><footer><ul id="footerstuff"><li>Powered by HTML &amp; CSS</li><li>Copyright © 2019 Fanael Linithien</li><li>Licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></li></ul></footer></body></html>